<div class="toolbar">
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'note'">
    <button
      (click)="note()"
      class="toolbar-button">
      <team-up-svg-icon
        icon="add"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Note</div>
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'select'">
    <button
      (click)="select()"
      class="toolbar-button">
      <mat-icon class="material-icons-outlined">crop_free</mat-icon>
    </button>
    <div class="toolbar-tooltip">Select</div>
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'group'">
    <button
      class="toolbar-button"
      (click)="group()">
      <team-up-svg-icon
        icon="template"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Group</div>
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'vote'">
    <button
      class="toolbar-button"
      (click)="vote()">
      <team-up-svg-icon
        icon="voting_chip"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Vote</div>
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'emoji'">
    <button
      class="toolbar-button"
      (click)="emoji()">
      <team-up-svg-icon
        icon="mood"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Add emoji</div>
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'draw'">
    <button
      class="toolbar-button"
      (click)="draw()">
      <team-up-svg-icon
        icon="edit"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Draw</div>
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'cocomaterial'">
    <button
      class="toolbar-button"
      (click)="cocomaterial()">
      <team-up-svg-icon
        icon="cocomaterial"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Cocomaterial</div>
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'image'">
    <button
      class="toolbar-button"
      (click)="popupOpen('image')">
      <team-up-svg-icon
        icon="picture"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Image</div>
    @if (popup() === 'image') {
      <div class="toolbar-container">
        <div class="toolbar-popup image-popup">
          <form
            [formGroup]="imageForm"
            (submit)="newImage()">
            <span class="popup-title">Image url</span>
            <input
              teamUpAutofocus
              formControlName="url"
              autocomplete="off"
              matInput
              class="image-url-field" />
            <div class="actions">
              <button
                class="submit"
                type="submit"
                mat-raised-button
                color="primary">
                Submit
              </button>
              <button
                (click)="popupOpen('')"
                class="cancel"
                type="text"
                mat-raised-button
                color="warn">
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>
    }
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'token'">
    <button
      (click)="token()"
      class="toolbar-button">
      <mat-icon class="material-icons-outlined">circle</mat-icon>
    </button>
    <div class="toolbar-tooltip">Token</div>
  </div>
  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'estimation'">
    <button
      class="toolbar-button"
      (click)="estimation()">
      <mat-icon class="material-icons-outlined">style</mat-icon>
    </button>
    <div class="toolbar-tooltip">Estimation</div>
  </div>

  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'text'">
    <button
      class="toolbar-button"
      (click)="text()">
      <team-up-svg-icon
        icon="letter"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Text</div>
  </div>

  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'panel'">
    <button
      class="toolbar-button"
      (click)="panel()">
      <team-up-svg-icon
        icon="panel"
        class="icon-svg"></team-up-svg-icon>
    </button>
    <div class="toolbar-tooltip">Panel</div>
  </div>

  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'poll'">
    <button
      class="toolbar-button"
      (click)="poll()">
      <mat-icon class="material-icons-outlined">poll</mat-icon>
    </button>
    <div class="toolbar-tooltip">Poll</div>
  </div>

  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'templates'">
    <button
      class="toolbar-button"
      (click)="templateSelector()">
      <mat-icon class="material-icons-outlined">view_quilt</mat-icon>
    </button>
    <div class="toolbar-tooltip">Templates</div>
  </div>

  <div
    class="toolbar-button-container"
    [class.active]="popup() === 'search'">
    <button
      class="toolbar-button"
      (click)="search()">
      <mat-icon>search</mat-icon>
    </button>
    <div class="toolbar-tooltip">Search</div>
  </div>
</div>

@defer (prefetch on idle) {
  @if (popup() === 'token') {
    <div class="tokens">
      <team-up-token-selector (selectToken)="tokenSelected($event)" />
    </div>
  }

  @if (popup() === 'emoji') {
    <div class="emojis">
      <emoji-picker
        (emoji-click)="emojiSelected($event)"
        class="light" />
    </div>
  }

  @if (popup() === 'templates') {
    <div class="tokens">
      <team-up-template-selector (selected)="seletedTemplate()" />
    </div>
  }
}
